{% extends "bootstrap/base.html" %}
{% import "bootstrap/wtf.html" as wtf %}
{% import "bootstrap/fixes.html" as fixes %}
{% import "bootstrap/utils.html" as util %}

{% block content %}
{{util.flashed_messages(dismissible=True)}}
<div class="container">
  <h1>LUG VPN</h1>
  <p>
    You have logged in as {{ user.email }}
    <a href="{{ url_for('logout') }}">Log out</a>
  </p>
  {% if user.apply=='none' %}
    <a class="btn btn-lg btn-primary" type="button" href="{{ url_for('apply') }}">Apply</a>
  {% elif user.apply=='applying' %}
    <h3>
      <span class="label label-info">Your VPN application is under review</span>
    </h3>
  {% elif user.apply=='pass' %}
    <h3>
      <span class="label label-success">Your VPN application has passed, you can launch your VPN with your email and password here</span>
    </h3>
    <h3>Recent Login</h3>
    <table class="table">
        <thead>
            <tr>
                <th>Start time</th>
                <th>Stop time</th>
                <th>IP</th>
                <th>Upload traffic</th>
                <th>Download traffic</th>
            </tr>
        </thead>
        <tbody>
        {% for r in records %}
            <tr>
                <td>{{r.acctstarttime}}</td>
                <td>
                    {%if r.acctstoptime%}
                        {{r.acctstoptime}}
                    {%elif r.acctstarttime%}
                        Still login
                    {%endif%}
                </td>
                <td>{{r.callingstationid}}</td>
                <td>{{sizeof_fmt(r.acctinputoctets)}}</td>
                <td>{{sizeof_fmt(r.acctoutputoctets)}}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
  {% elif user.apply=='reject' %}
    <h3>
      <span class="label label-danger">Sorry, Your VPN application has been rejected</span>
    </h3>
  {% endif %}
  {% if user.admin %}
    <a class="btn btn-lg btn-warning" type="button" href="{{ url_for('manage') }}">Manage users</a>
  {% endif %}
</div>
{% endblock %}

{% block head %}
{{super()}}
{{fixes.ie8()}}
{% endblock %}
